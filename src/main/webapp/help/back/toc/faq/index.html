<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="index.files/filelist.xml">
<link rel=Edit-Time-Data href="index.files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>开发常见问题及解答</title>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="State"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="place"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="chsdate"/>
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:黑体;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimHei;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1610611985 1073750139 0 0 159 0;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-1610611985 1073741899 0 0 159 0;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:auto;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:"\@黑体";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:auto;
	mso-font-signature:0 0 0 0 0 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	font-size:10.5pt;
	font-family:Calibri;
	mso-fareast-font-family:宋体;
	mso-bidi-font-family:宋体;}
h1
	{margin-top:17.0pt;
	margin-right:0cm;
	margin-bottom:16.5pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:0cm;
	line-height:240%;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:22.0pt;
	font-family:Calibri;
	mso-bidi-font-family:宋体;
	font-weight:bold;}
h2
	{margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:0cm;
	line-height:172%;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:16.0pt;
	font-family:Cambria;
	mso-bidi-font-family:宋体;
	font-weight:bold;}
h3
	{margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:0cm;
	line-height:172%;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:16.0pt;
	font-family:Calibri;
	mso-bidi-font-family:宋体;
	font-weight:bold;}
h4
	{margin-top:14.0pt;
	margin-right:0cm;
	margin-bottom:14.5pt;
	margin-left:43.2pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-43.2pt;
	line-height:155%;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:10.5pt;
	font-family:Arial;
	font-weight:bold;}
h5
	{margin-top:14.0pt;
	margin-right:0cm;
	margin-bottom:14.5pt;
	margin-left:50.4pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-50.4pt;
	line-height:155%;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:14.0pt;
	font-family:Arial;
	font-weight:bold;}
h6
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.2pt;
	margin-left:57.6pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-57.6pt;
	line-height:132%;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:6;
	font-size:12.0pt;
	font-family:Cambria;
	mso-bidi-font-family:宋体;
	font-weight:bold;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.2pt;
	margin-left:64.8pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-64.8pt;
	line-height:132%;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:7;
	font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:宋体;
	font-weight:bold;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.2pt;
	margin-left:72.0pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-72.0pt;
	line-height:132%;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:8;
	font-size:12.0pt;
	font-family:Cambria;
	mso-fareast-font-family:宋体;
	mso-bidi-font-family:宋体;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.2pt;
	margin-left:79.2pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-79.2pt;
	line-height:132%;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:9;
	font-size:10.5pt;
	font-family:Cambria;
	mso-fareast-font-family:宋体;
	mso-bidi-font-family:宋体;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	layout-grid-mode:char;
	font-size:9.0pt;
	font-family:Calibri;
	mso-fareast-font-family:宋体;
	mso-bidi-font-family:宋体;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0cm;
	margin-bottom:.0001pt;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	layout-grid-mode:char;
	font-size:9.0pt;
	font-family:Calibri;
	mso-fareast-font-family:宋体;
	mso-bidi-font-family:宋体;}
a:link, span.MsoHyperlink
	{color:#2779B6;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	font-size:9.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
p
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:2.7pt;
	margin-left:0cm;
	text-indent:24.0pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
p.listparagraph, li.listparagraph, div.listparagraph
	{mso-style-name:listparagraph;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:21.0pt;
	mso-pagination:widow-orphan;
	font-size:10.5pt;
	font-family:Calibri;
	mso-fareast-font-family:宋体;
	mso-bidi-font-family:宋体;}
p.315, li.315, div.315
	{mso-style-name:315;
	margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:36.0pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-36.0pt;
	line-height:150%;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;
	letter-spacing:.5pt;
	font-weight:bold;}
span.headerchar
	{mso-style-name:headerchar;
	font-family:"Times New Roman";
	mso-ascii-font-family:"Times New Roman";
	mso-hansi-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
span.footerchar
	{mso-style-name:footerchar;
	font-family:"Times New Roman";
	mso-ascii-font-family:"Times New Roman";
	mso-hansi-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
span.heading1char
	{mso-style-name:heading1char;
	font-family:"Times New Roman";
	mso-ascii-font-family:"Times New Roman";
	mso-hansi-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	font-weight:bold;}
span.heading2char
	{mso-style-name:heading2char;
	font-family:Cambria;
	mso-ascii-font-family:Cambria;
	mso-hansi-font-family:Cambria;
	font-weight:bold;}
span.heading3char
	{mso-style-name:heading3char;
	font-family:"Times New Roman";
	mso-ascii-font-family:"Times New Roman";
	mso-hansi-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	font-weight:bold;}
span.documentmapchar
	{mso-style-name:documentmapchar;
	font-family:宋体;
	mso-ascii-font-family:宋体;
	mso-fareast-font-family:宋体;
	mso-hansi-font-family:宋体;}
 /* Page Definitions */
 @page
	{mso-footnote-separator:url("index.files/header.html") fs;
	mso-footnote-continuation-separator:url("index.files/header.html") fcs;
	mso-endnote-separator:url("index.files/header.html") es;
	mso-endnote-continuation-separator:url("index.files/header.html") ecs;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-even-header:url("index.files/header.html") eh1;
	mso-header:url("index.files/header.html") h1;
	mso-even-footer:url("index.files/header.html") ef1;
	mso-footer:url("index.files/header.html") f1;
	mso-first-header:url("index.files/header.html") fh1;
	mso-first-footer:url("index.files/header.html") ff1;
	mso-paper-source:0;
	layout-grid:15.6pt;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:1382824761;
	mso-list-type:hybrid;
	mso-list-template-ids:1331959666 -390715082 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l0:level1
	{mso-level-start-at:0;
	mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:23.0pt;
	mso-level-number-position:left;
	margin-left:23.0pt;
	text-indent:-18.0pt;
	font-family:Wingdings;
	mso-fareast-font-family:宋体;
	mso-bidi-font-family:"Courier New";}
@list l1
	{mso-list-id:1837452991;
	mso-list-type:hybrid;
	mso-list-template-ids:-639328644 -1347619910 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l1:level1
	{mso-level-start-at:0;
	mso-level-number-format:bullet;
	mso-level-text:\F06C;
	mso-level-tab-stop:23.0pt;
	mso-level-number-position:left;
	margin-left:23.0pt;
	text-indent:-18.0pt;
	font-family:Wingdings;
	mso-fareast-font-family:宋体;
	mso-bidi-font-family:"Courier New";}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:普通表格;
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="3074"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=ZH-CN link="#2779B6" vlink=purple style='tab-interval:21.0pt;
text-justify-trim:punctuation'>

<div class=Section1 style='layout-grid:15.6pt'>

<p class=MsoNormal><b><span style='font-size:20.0pt;font-family:宋体'>开发常见问题及解答</span></b></p>

<h1 style='margin-left:21.25pt;text-indent:-21.25pt'><span lang=EN-US>1</span><span
lang=EN-US style='font-size:7.0pt;line-height:240%;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>表单</span></h1>

<h2><span lang=EN-US>1.1</span><a name="Form_Type"><span style='font-family:
宋体'>表单的类型</span></a></h2>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>表单类型分为普通，查询表单，普通（映射）表单。</span></p>

<p class=MsoNormal><span lang=EN-US>(1)</span><span style='font-family:宋体'>普通，常规的表单配置</span></p>

<p class=MsoNormal><span lang=EN-US>(2)</span><span style='font-family:宋体'>查询表单，主要为视图列表配置查询头，要与视图配置结合使用</span></p>

<p class=MsoNormal><span lang=EN-US>(3)</span><span style='font-family:宋体'>映射表单，可以调用应用软件在同一个数据库中不属于平台生成的数据表，通过字段的映射，对该表进行数据查询，修改，添加，删除操作</span></p>

<h2><span lang=EN-US>1.2</span><span style='font-family:宋体'>控件属性</span></h2>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>1.2.1</span></st1:chsdate><a
name="Field_Refresh"></a><span style='font-family:宋体'>刷新</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>控件刷新属性，是指当控件的内容发生改变时，触发包含当前控件的表单的刷新事件，以通知表单中其它具有重计算属性的控件进行刷新。</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>1.2.2</span></st1:chsdate><a
name="Field_ReCalculate"></a><span style='font-family:宋体'>重计算</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>控件重计算属性，是指当控件配置选择重计算时，则包含当前控件的表单，其刷新事件被触发时，当前控件的脚本将被重新运算，以实现与最新数据同步</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>1.2.3</span></st1:chsdate><a
name="Field_Mobile"></a><span style='font-family:宋体'>手机</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>控件手机属性，是指当控件配置选择手机时，通过</span><span
lang=EN-US>MYAPPS</span><span style='font-family:宋体'>智能客户端访问平台应用，则此控件将在智能客户端上显示，否则不显示。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>1.2.4</span></st1:chsdate><a
name="Field_ValueScript"></a><span style='font-family:宋体'>值脚本</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>控件值脚本，是指可能通过脚本来决定控件的值。</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>1</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>表单字段计算</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:95.25pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:95.25pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>/*
  </span><span style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>这里我们用单价与数量，计算金额为例进行讲解。<span
  lang=EN-US><o:p></o:p></span></span></p>
  <p class=MsoNormal align=left style='text-align:left;text-indent:5.0pt;
  text-autospace:none'><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#3F7F5F'>*</span><span lang=EN-US style='font-size:10.0pt;
  font-family:宋体;color:#3F7F5F'> </span><span style='font-size:10.0pt;
  font-family:宋体;color:#3F7F5F'>表单中有一个字段</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>“</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>单价</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>”</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>，数字类型；有一个字段</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>“</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>数量</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>”</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>，数字类型；有一个字段</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>“</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>金额</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>”</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>，数字类型。<span lang=EN-US><o:p></o:p></span></span></p>
  <p class=MsoNormal align=left style='text-align:left;text-indent:5.0pt;
  text-autospace:none'><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#3F7F5F'>* </span><span style='font-size:10.0pt;
  font-family:宋体;color:#3F7F5F'>单价和数量两个字段都选择了</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>“</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>刷新</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>”</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>属性，金额字段选择了</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>“</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>重计算</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>”</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>属性。<span lang=EN-US><o:p></o:p></span></span></p>
  <p class=MsoNormal align=left style='text-align:left;text-indent:5.0pt;
  text-autospace:none'><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#3F7F5F'>* </span><span style='font-size:10.0pt;
  font-family:宋体;color:#3F7F5F'>其中，金额字段写有值脚本。<span lang=EN-US><o:p></o:p></span></span></p>
  <p class=MsoNormal align=left style='text-align:left;text-indent:5.0pt;
  text-autospace:none'><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> price
  = getItemValueAsDouble(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>单价</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  count = getItemValueAsDouble(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>数量</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>price * count;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>2</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>汇总子表单字段值</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:79.0pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:79.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/* </span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>这里我们以汇总子表</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#3F7F5F'>“</span><span style='font-size:10.0pt;
  font-family:宋体;color:#3F7F5F'>金额</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#3F7F5F'>”</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>字段为例进行讲解。<span
  lang=EN-US><o:p></o:p></span></span></p>
  <p class=MsoNormal style='text-indent:5.0pt'><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'> </span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>主表有一字段为</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>“</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>总金额</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>”</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>，数字类型；子表有一字段为</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>“</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>金额</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>”</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>，数字类型。<span lang=EN-US><o:p></o:p></span></span></p>
  <p class=MsoNormal style='text-indent:5.0pt'><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>* </span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>子表包含元素控件选择了</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>“</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>刷新</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>”</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>属性，总金额字段选择了</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>“</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>重计算</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>”</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>属性。<span lang=EN-US><o:p></o:p></span></span></p>
  <p class=MsoNormal style='text-indent:5.0pt'><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>* </span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>其中，总金额字段写有值脚本。<span
  lang=EN-US><o:p></o:p></span></span></p>
  <p class=MsoNormal style='text-indent:5.0pt'><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>此函数有两个参数，第一个参数：子表单名称；第二个参数：汇总字段名称。</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>sumSubDocument(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>子表明细</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>金额</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>3</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>子表单记录计数</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:32.0pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:32.0pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>/*</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>这里我们以获取子表记录数为例。</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>countSubDocument(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>子表单名称</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>4</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>自动编号</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>/*</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>方法</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>1,
  </span><span style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>创建数据但未保存时，会出现断号的情况。生成</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>TLK0001</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>、</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>TLK0002</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>、</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>TLK0003......*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  number = getItemValue(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>字段名</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(number
  ==</span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>null</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> || number.trim().length()&lt;=0){ </span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  number = countNext2(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;TLK&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>false</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>false</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>false</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,4);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>number;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>方法</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#3F7F5F'>2, </span><span style='font-size:10.0pt;
  font-family:宋体;color:#3F7F5F'>创建数据但未保存时，会出现断号的情况。生成</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>TLK201101050001</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>、</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>TLK201101050002</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>、</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>TLK201101050003......*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  number = getItemValue(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>字段名</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(number
  ==</span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>null</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> || number.trim().length()&lt;=0){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  number = countNext2(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;TLK&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>true</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>true</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>true</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,4);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>number;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>1.2.5</span></st1:chsdate><a
name="Field_OptionScript"></a><span style='font-family:宋体'>选项脚本</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>控件选项脚本，是指通过脚本来创建出控件的可选择项，支持固定选项、动态生成选项。</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例：</span></b></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>/*</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>方法</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>1:</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>固定选项列表，选项名与选项值相同。</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>选项</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>1;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>选项</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>2;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>选项</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>3;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>选项</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>4&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>/*</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>方法</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>2:</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>固定选项列表，选项名与选项值不相同。</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  opts=createOptions();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>opts.add(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>opts.add(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>选项</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>1&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;1&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>opts.add(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>选项</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>2&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;2&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>opts.add(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>选项</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>3&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;3&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>opts.add(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>选项</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>4&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;4&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>opts;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>/*</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>方法</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>3</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>：动态生成选项列表，从基础表中获取数据动态生成选项。</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>获取所有区域</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  opts=createOptions();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>opts.add(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  dql = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;$formname='/</span><span style='font-size:10.0pt;
  font-family:宋体;color:#2A00FF'>片区信息表</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'>'&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  datas&nbsp; =queryByDQL(dql);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(datas!=</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>null</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  &amp;&amp; datas.size()&gt;0){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>for</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>(</span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> iter
  = datas.iterator();iter.hasNext();){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> doc = iter.next();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  opts.add(doc.getItemValueAsString(</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>片区</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>),doc.getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>'</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>片区代码</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>'</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>));</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  }</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>opts;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>/*</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>方法</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>4</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>：动态生成选项列表，从基础表中动态生成选项。</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>&nbsp;*
  </span><span style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>从基础表中动态生成选项列表。选项名与选项值取不同字段的值。</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>&nbsp;*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  dql = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;$formname='/</span><span style='font-size:10.0pt;
  font-family:宋体;color:#2A00FF'>片区信息表</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'>'&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  key = </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>new</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> Array();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>key[0]
  = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;</span><span style='font-size:10.0pt;font-family:宋体;
  color:#2A00FF'>片区代码</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>key[1]
  = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;</span><span style='font-size:10.0pt;font-family:宋体;
  color:#2A00FF'>片区</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#2A00FF'>&quot;</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>getOptionsByDQL(dql,key,</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>true</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>/*</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>方法</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>5</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>：动态生成选项列表，从基础表中动态生成选项。</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>&nbsp;*
  </span><span style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>选项名与选项值取同一个字段的值。</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>&nbsp;*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  dql = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;$formname='/</span><span style='font-size:10.0pt;
  font-family:宋体;color:#2A00FF'>片区信息表</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'>'&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>getOptionsByDQL(dql,</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>片区</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>true</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>1.2.<a name="Field_ValidateScript">6</a></span><span
 style='mso-bookmark:Field_ValidateScript'></span></st1:chsdate><span
style='font-family:宋体'>校验脚本</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>控件校验脚本，是指通过脚本来对表单控件内容进行校验。</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>1</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>判断是否为空</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:113.25pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:113.25pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>这里我们以校验“名称”字段是否填写内容为例。</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  value = getItemValueAsString(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>名称</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  (value==</span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>null</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> || value.trim().length()&lt;=0){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;</span><span style='font-size:10.0pt;font-family:宋体;
  color:#2A00FF'>名称字段必须填写！</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>rtn;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>2</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>判断是否为数字</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:113.25pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:113.25pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>这里我们以校验“数量”字段填写内容是否为数字为例。</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> value
  = getItemValueAsString(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>数量</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  (!isNumberText(value)){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;</span><span style='font-size:10.0pt;font-family:宋体;
  color:#2A00FF'>字段内容必需为数字！</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>rtn;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b><span lang=EN-US>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US>&nbsp;</span></b></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>3</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>判断是否为邮件地址</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:113.25pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:113.25pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>这里我们以校验“</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#3F7F5F'>email</span><span style='font-size:
  10.0pt;font-family:宋体;color:#3F7F5F'>”字段填写内容是否为</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>Email</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>地址为例。</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  value = getItemValueAsString(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;email&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  (!isMailAddressText(value)){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;</span><span style='font-size:10.0pt;font-family:宋体;
  color:#2A00FF'>非法的</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#2A00FF'>Email</span><span style='font-size:10.0pt;
  font-family:宋体;color:#2A00FF'>地址！</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>rtn;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>4</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>判断是否为正数</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:113.25pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:113.25pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>这里我们以校验“数量”字段填写内容是否为正数为例。</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  value = getItemValueAsDouble(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>数量</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  (!isPositive(value)){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;</span><span style='font-size:10.0pt;font-family:宋体;
  color:#2A00FF'>数量必需大于</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>0</span><span style='font-size:10.0pt;
  font-family:宋体;color:#2A00FF'>！</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>rtn;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>5</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>表单中的</span><span
lang=EN-US>2</span><span style='font-family:宋体'>个字段进行比较</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:129.5pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:129.5pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>这里我们以校验“总额”字段与“实际金额”字段比较为例。</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> total_amount
  = getItemValueAsDouble(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>总额</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  amount = getItemValueAsDouble(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>实际金额</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  (total_amount&lt; amount){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;</span><span style='font-size:10.0pt;font-family:宋体;
  color:#2A00FF'>实际金额不能大于总额！</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>rtn;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>6</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>获取参数表中的值，并进行比较</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:129.5pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:129.5pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>这里我们以校验“总额”参数与“实际金额”参数比较为例。</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  total_amount = getParameterAsDouble(</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>总额</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  amount = getParameterAsDouble(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>实际金额</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  (total_amount&lt; amount){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;</span><span style='font-size:10.0pt;font-family:宋体;
  color:#2A00FF'>实际金额不能大于总额！</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>rtn;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>7</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>判断记录是否已存在</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:161.5pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:161.5pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>这里我们以校验“任务编号”是否已存在为例。</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  code = getItemValueAsString(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>任务编号</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  dql = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;$formname='fm_task' and code='&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>+code
  + </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;' and $id&lt;&gt;'&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'> + getId() + </span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;'&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  datas = queryByDQL(dql);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  (datas!=</span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>null</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> &amp;&amp; datas.size()&gt;0){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;</span><span style='font-size:10.0pt;font-family:宋体;
  color:#2A00FF'>任务编号</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>+code+</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>已经存在！</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>rtn;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>1.2.<a name="Field_HiddenScript">7</a></span><span
 style='mso-bookmark:Field_HiddenScript'></span></st1:chsdate><span
style='font-family:宋体'>隐藏脚本</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>控件隐藏脚本，是指当脚本返回值为</span><span lang=EN-US>true</span><span
style='font-family:宋体'>时，控件隐藏，当返回值为</span><span lang=EN-US>false</span><span
style='font-family:宋体'>时，控件显示。</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>1</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>判断当前用户部门，并决定是否隐藏</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:259.0pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:259.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>这里我们以非“总经办”的用户不可查看“合同总额”字段信息为例。我们在“合同总额”字段隐藏脚本。</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>1</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>表示一级部门</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  deptid = getDeptIdByNameAndLevel(</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>总经办</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,1);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  dpts = getWebUser().getDepartments();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  isHidden = </span><b><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#7F0055'>true</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  (dpts!=</span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>null</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> &amp;&amp; dpts.size()&gt;0){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055;background:silver'>for</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'> (</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> it
  = dpts.iterator();it.hasNext();){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> dptVO = it.next();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>if</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> (deptid.equals(dptVO.getId())){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  &nbsp;&nbsp;&nbsp; isHidden = </span><b><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#7F0055'>false</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  &nbsp;&nbsp;&nbsp; </span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#7F0055'>break</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;
  }</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;
  <span style='background:silver'>}</span></span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>isHidden;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>2</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>判断当前用户角色，并决定是否隐藏</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:242.75pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:242.75pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>这里我们以非“总经理”的角色用户不可查看“合同总额”字段信息为例。我们在“合同总额”字段隐藏脚本填写脚本。</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  roleid = getRoleIdByName(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>总经理</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> roles
  = getWebUser().getRoles();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  isHidden = </span><b><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#7F0055'>true</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  (roles!=</span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>null</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> &amp;&amp; roles.size()&gt;0){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>for</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> (</span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> it
  = roles.iterator();it.hasNext();){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> roleVO = it.next();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>if</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> (roleid.equals(roleVO.getId())){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  &nbsp;&nbsp;&nbsp; isHidden = </span><b><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#7F0055'>false</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  &nbsp;&nbsp;&nbsp; </span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#7F0055'>break</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;
  }</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;
  }</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>isHidden;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>3</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>判断当前表单另一字段值，并决定是否隐藏</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:129.0pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:129.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>这里我们以表单“任务类型”字段值状态为例。我们在“开发者”字段隐藏脚本填写脚本。当为非开发任务时，隐藏</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>“</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>开发者</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>”*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  type = getItemValueAsString(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>任务类型</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  isHidden = </span><b><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#7F0055'>true</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> (</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>开发任务</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>.equals(type)){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;isHidden
  = </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>false</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>isHidden;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>4</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>判断当前表单处于新建还是编辑状态，并决定是否隐藏</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:48.25pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:48.25pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>这里我们以表单为编辑状态时显示字段值信息为例。“建单人”字段隐藏脚本。</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  doc = getCurrentDocument();</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>doc.getIstmp();</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>1.2.<a
 name="Field_PrintHiddenScript">8</a></span><span style='mso-bookmark:Field_PrintHiddenScript'></span></st1:chsdate><span
style='font-family:宋体'>打印时隐藏脚本</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>控件打印时隐藏脚本，当脚本返回值为</span><span
lang=EN-US>true</span><span style='font-family:宋体'>，文档打印时隐藏控件内容；脚本返回值为</span><span
lang=EN-US>false</span><span style='font-family:宋体'>，文档打印时显示控件内容。</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>1.2.<a name="Field_ReadOnlyScript">9</a></span><span
 style='mso-bookmark:Field_ReadOnlyScript'></span></st1:chsdate><span
style='font-family:宋体'>只读脚本</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>控件只读脚本，当脚本返回值为</span><span
lang=EN-US>true</span><span style='font-family:宋体'>，表单字段只读；当脚本返回值为</span><span
lang=EN-US>false</span><span style='font-family:宋体'>，表单字段可编辑。</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例：</span></b><span
style='font-family:宋体'>只作者可编辑</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:113.25pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:113.25pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  doc = getCurrentDocument();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  user = getWebUser();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  isReadOlny = </span><b><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#7F0055'>true</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  (user.getId().equals(doc.getAutho().getId())){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  isReadOlny = </span><b><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#7F0055'>false</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>isReadOlny;</span></p>
  </td>
 </tr>
</table>

<h2><span lang=EN-US>1.3</span><span style='font-family:宋体'>操作</span></h2>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>1.3.1</span></st1:chsdate><a
name="Form_Activity"></a><span style='font-family:宋体'>基本操作类型</span></h3>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='border:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><b><span
  style='font-size:12.0pt;font-family:宋体'>前台效果图</span></b></p>
  </td>
  <td style='border:solid windowtext 1.0pt;border-left:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'><b><span
  style='font-size:12.0pt;font-family:宋体'>名称</span></b></p>
  </td>
  <td style='border:solid windowtext 1.0pt;border-left:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'><b><span
  style='font-size:12.0pt;font-family:宋体'>简述</span></b></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=60 height=23
  id="_x0000_i1025" src="index.files/image001.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>查询</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>用于对应视图的查询表单功能。</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=124 height=21
  id="_x0000_i1026" src="index.files/image002.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>保存</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>执行保存操作。</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=122 height=22
  id="_x0000_i1027" src="index.files/image003.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>保存</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>执行保存并触发流程</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=92 height=24
  id="_x0000_i1028" src="index.files/image004.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>保存并返回</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>执行保存操作后返回上一级页面。</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=167 height=25
  id="_x0000_i1029" src="index.files/image005.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>保存并新建</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>执行保存操作后并创建新的操作，而且会带有原来的数据。</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=179 height=25
  id="_x0000_i1030" src="index.files/image006.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>保存并新建</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>执行保存操作后并创建新的操作，但不会带有原来的数据。</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=141 height=22
  id="_x0000_i1031" src="index.files/image007.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>保存</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>执行保存操作后不进行数据校验。</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=94 height=24
  id="_x0000_i1032" src="index.files/image008.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>保存并复制</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>执行保存操作后并进行复制。</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=119 height=27
  id="_x0000_i1033" src="index.files/image009.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>保存并关闭窗口</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>执行保存操作后关闭窗口。</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=65 height=22
  id="_x0000_i1034" src="index.files/image010.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>返回</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>返回上一级页面。</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=61 height=25
  id="_x0000_i1035" src="index.files/image011.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>打印</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>数据表进行打印。</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=115 height=23
  id="_x0000_i1036" src="index.files/image012.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>带流程历史打印 </span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>打印数据表时并带有流程历史。</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=79 height=29
  id="_x0000_i1037" src="index.files/image013.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>流程处理</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>提交给下一个流程进行进一步处理。</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:14'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=83 height=28
  id="_x0000_i1038" src="index.files/image014.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>脚本处理 </span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>对脚本进行处理。</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:15'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=78 height=25
  id="_x0000_i1039" src="index.files/image015.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>关闭窗口</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>把当前的窗口关闭。</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:16'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=97 height=29
  id="_x0000_i1040" src="index.files/image016.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>编辑审批人</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>对数据信息进行操作、修改的人。</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:17'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=81 height=25
  id="_x0000_i1041" src="index.files/image017.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'>PDF</span><span style='font-size:
  12.0pt;font-family:宋体'>导出</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>数据信息以<span lang=EN-US>PDF</span>格式进行导出。</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:18'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=85 height=25
  id="_x0000_i1042" src="index.files/image018.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>文件下载</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>下载相关文件，文件路径如：”<span lang=EN-US>/uploads/aaa.txt</span>”<span
  lang=EN-US>,</span>那么在发布项目的<span lang=EN-US>uploads</span>目录下的<span
  lang=EN-US>aaa.txt</span>文件会被下载。</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:19'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=83 height=25
  id="_x0000_i1043" src="index.files/image019.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>电子签章</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>对电子文档进行电子签章。</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:20'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=82 height=26
  id="_x0000_i1044" src="index.files/image020.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>动态打印</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>数据进行嵌套打印。用户可根据自己的需求设计打印界面及其字段实现自定义打印。</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:21'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=58 height=24
  id="_x0000_i1045" src="index.files/image021.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>跳转</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>跳转到对应的表单</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:22;mso-yfti-lastrow:yes'>
  <td style='border:solid windowtext 1.0pt;border-top:none;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-size:12.0pt;font-family:宋体'><img width=91 height=24
  id="_x0000_i1046" src="index.files/image022.gif"></span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>流程启动</span></p>
  </td>
  <td style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 0cm 0cm 0cm'>
  <p class=MsoNormal align=left style='text-align:left'><span style='font-size:
  12.0pt;font-family:宋体'>触发流程</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>1.3.2</span></st1:chsdate><a
name="Activity_BeforeAction"></a><span style='font-family:宋体'>动作执行前脚本</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>表单按钮动作执行前脚本，是指按钮的动作执行前触发此脚本。通常也可以用来进行校验操作。当此脚本返回值为：字符串对象、</span><span
lang=EN-US>Alert</span><span style='font-family:宋体'>对象（通过</span><span
lang=EN-US>createAlert</span><span style='font-family:宋体'>函数创建）、</span><span
lang=EN-US>Confirm</span><span style='font-family:宋体'>对象（可通过</span><span
lang=EN-US>createConfirm</span><span style='font-family:宋体'>函数创建）。</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>1</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>执行前显示</span><span
lang=EN-US>Alert</span><span style='font-family:宋体'>窗口</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:80.75pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:80.75pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>这里我们以“提交”按钮动作执行前脚本为例。</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  code = getItemValueAsString(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>任务编号</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  (code ==</span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>null</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> || code.trim().length()&lt;=0){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;
  createAlert(</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;</span><span style='font-size:10.0pt;font-family:宋体;
  color:#2A00FF'>任务编号不能为空！</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>}</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>2</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>执行前显示</span><span
lang=EN-US>Confirm</span><span style='font-family:宋体'>窗口</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:32.0pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:32.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>这里我们以“提交”按钮动作执行前脚本为例。</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>createConfirm(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>确定要提交文档？</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>1.3.3</span></st1:chsdate><a
name="Activity_AfterAction"></a><span style='font-family:宋体'>动作执行后脚本</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>表单按钮动作执行后脚本，是指按钮的动作执行后触发此脚本。</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>1</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>保存当前文档，并根据当前表单的内容创建另一文档</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:209.0pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:209.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>这里我们以“保存”按钮动作执行后脚本为例。</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  formProcess = getFormProcess();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>查询出表单</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  form = formProcess.doViewByFormName(</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;fm_purchase_materials&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,getApplication());</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  process = <span style='background:silver'>getDocumentProcess</span>();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  doc = process.doNew(form,getWebUser(),createParamsTable());</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>doc.findItem(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;title&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>).setValue(getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>标题</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>));</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>doc.findItem(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;type&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>).setValue(getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>类型</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>));</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>doc.findItem(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;count&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>).setValue(getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>数量</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>));</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>doc.setIstmp(</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>false</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>process.doCreate(doc);</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>2</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>保存当前文档，并发送邮件通知</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:162.0pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:162.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>这里我们以“保存”按钮动作执行后脚本为例。</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  from=getItemValueAsString(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;from&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  to=getItemValueAsString(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;to&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  host=getItemValueAsString(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;host&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  user=getItemValueAsString(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;user&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  password=getItemValueAsString(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;password&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  bbc=getItemValueAsString(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;bbc&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  subject=getItemValueAsString(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;subject&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  body=getItemValueAsString(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;body&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>sendMail(from, to, subject, body, host, user, password, bbc,
  fasle);</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>3</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>保存当前文档，自动生成编号</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>/*</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>自动编号，此种生成方式编号会连号，让编号利用率到最高。当点击保存按钮，数据保存成功后，生成</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>TLK201101001</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>、</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>TLK201101002</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>、</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>TLK201101003......*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>保存动作执行后脚本</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  doc = getCurrentDocument();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  value = doc.getItemValueAsString(</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;code1&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(value
  == </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>null</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>&nbsp; ||&nbsp; value.trim().length()
  &lt;= 0){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  value = countNext2(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;TLK&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>true</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>true</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>false</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,4);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  doc.findItem(</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#2A00FF'>&quot;code1&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>).setValue(value);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> process =
  getDocProcess(getApplication());&nbsp;&nbsp; </span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//Document</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>操作类</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  process.doUpdate(doc);</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>}</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h1><span lang=EN-US>2</span><span style='font-family:宋体'>视图</span></h1>

<h2><span lang=EN-US>2.1</span><a name="View_Type"><span style='font-family:
宋体'>视图的类型</span></a></h2>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>视图的类型分为：普通，日历视图，树形视图，地图视图，甘特视图</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>(1)</span><span lang=EN-US style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>普通，常规的视图配置</span></p>

<p class=MsoNormal><span lang=EN-US>(2)</span><span lang=EN-US
style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>日历视图，类似挂历或备忘录的形式陈列表单数据，通过映射字段映射表单的日期字段，根据该日期字段以每日，每周，每月显示数据（具体实例请参考</span><span
lang=EN-US>myApps</span><span style='font-family:宋体'>功能示例</span><span
lang=EN-US>/</span><span style='font-family:宋体'>视图示例</span><span lang=EN-US>/</span><span
style='font-family:宋体'>日历视图）。</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>月视图：</span></b></p>

<p class=MsoNormal><span lang=EN-US><img width=553 height=350 id="_x0000_i1047"
src="index.files/image023.jpg"></span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>周视图：</span></b></p>

<p class=MsoNormal><span lang=EN-US><img width=553 height=277 id="_x0000_i1048"
src="index.files/image024.jpg"></span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>日视图：</span></b></p>

<p class=MsoNormal><span lang=EN-US><img width=554 height=349 id="_x0000_i1049"
src="index.files/image025.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US>(3)</span><span lang=EN-US
style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>树形视图，以树形结构显示表单内容，字段中的层级关系通过视图列中映射字段设置来定义的，节点点击打开类型为对应视图和链接（具体实例请参考</span><span
lang=EN-US>myApps</span><span style='font-family:宋体'>功能示例</span><span
lang=EN-US>/</span><span style='font-family:宋体'>视图示例</span><span lang=EN-US>/</span><span
style='font-family:宋体'>树形视图（列表）或者树形视图（表单））。</span></p>

<p class=MsoNormal><span style='font-family:宋体'>前台显示效果：</span></p>

<p class=MsoNormal><span lang=EN-US><img width=553 height=114 id="_x0000_i1050"
src="index.files/image026.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US>(4)</span><span lang=EN-US
style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>地图视图，为用户提供地图位置，显示位置信息。使用</span><span
lang=EN-US>百度</span><span style='font-family:宋体'>地图的插件，需在可连互联网环境才能正常使用，通过映射字段映射地图控件（具体实例请参考</span><span
lang=EN-US>myApps</span><span style='font-family:宋体'>功能示例</span><span
lang=EN-US>/</span><span style='font-family:宋体'>视图示例</span><span lang=EN-US>/</span><span
style='font-family:宋体'>地图视图）。</span></p>

<p class=MsoNormal><span style='font-family:宋体'>前台显示效果：</span><span lang=EN-US><br>
<img width=553 height=335 id="_x0000_i1051" src="index.files/image027.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US>(5)</span><span lang=EN-US
style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>甘特视图，能更直观的统计每日，周，月，季的工作进展情况和完成进度，它通过映射字段对应表单需要的字段（具体实例请参考</span><span
lang=EN-US>myApps</span><span style='font-family:宋体'>功能示例</span><span
lang=EN-US>/</span><span style='font-family:宋体'>视图示例</span><span lang=EN-US>/</span><span
style='font-family:宋体'>甘特视图示例）。</span></p>

<p class=MsoNormal><span style='font-family:宋体'>前台显示效果：</span></p>

<p class=MsoNormal><span lang=EN-US><img width=553 height=92 id="_x0000_i1052"
src="index.files/image028.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h2><span lang=EN-US>2.2</span><a name="View_Filter"><span style='font-family:
宋体'>筛选条件定义</span></a></h2>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>1</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>在视图中列出单个数据表内容</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>通过视图基本信息中设置相关表单，即可对应单个表单的数据表，分别可以通过设计，代码（</span><span
lang=EN-US>DQL</span><span style='font-family:宋体'>），代码（</span><span lang=EN-US>SQL</span><span
style='font-family:宋体'>）来进行对列的条件过滤。</span><span lang=EN-US>(</span><span
style='font-family:宋体'>具体实例请参考</span><span lang=EN-US>myApps</span><span
style='font-family:宋体'>功能示例</span><span lang=EN-US>/</span><span
style='font-family:宋体'>视图示例</span><span lang=EN-US>/</span><span
style='font-family:宋体'>视图示例</span><span lang=EN-US>design</span><span
style='font-family:宋体'>、</span><span lang=EN-US>DQL</span><span
style='font-family:宋体'>和</span><span lang=EN-US>SQL)</span></p>

<p class=MsoNormal><span style='font-family:宋体'>以上实例中通过查询条件对应绑定查询表单里字段，根据查询表单字段内容对视图数据表进行筛选。</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:470.75pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:470.75pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>// DQL</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>语句</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>获取查询表单“字段</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#3F7F5F'>1</span><span style='font-size:10.0pt;
  font-family:宋体;color:#3F7F5F'>”和“字段</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#3F7F5F'>2</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>”的值，当查询表单中“字段</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>1</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>”和“字段</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>2</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>”的值等于“视图示例</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>_dql</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>”中“字段</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>1</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>”和“字段</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>2</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>”的值时，显示数据表为查询表单中中“字段</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>1</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>”和“字段</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>2</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>”对应内容的数据。</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> value1
  = getItemValue(</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#2A00FF'>&quot;</span><span style='font-size:10.0pt;
  font-family:宋体;color:#2A00FF'>字段</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'>1&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> <span
  style='background:silver'>value2</span> = getItemValue(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>字段</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>2&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  where = (value1 != </span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#7F0055'>null</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'> &amp;&amp;
  value1.trim().length() &gt; 0)?</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot; and </span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>字段</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>1='&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>+
  value1+</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;'&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>:</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>where
  += (<span style='background:silver'>value2</span> != </span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>null</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  &amp;&amp; <span style='background:silver'>value2</span>.trim().length() &gt;
  0)?</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot; and </span><span style='font-size:10.0pt;font-family:
  宋体;color:#2A00FF'>字段</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>2='&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>+ <span
  style='background:silver'>value2</span> + </span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;'&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>:</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;$formname='</span><span style='font-size:10.0pt;
  font-family:宋体;color:#2A00FF'>视图示例</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'>_dql' &quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> +
  where;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>//SQL</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>语句</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>获取查询表单“字段</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#3F7F5F'>1</span><span style='font-size:10.0pt;
  font-family:宋体;color:#3F7F5F'>”的值，当查询表单中“字段</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>1</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>”的值等于“视图示例</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>_sql</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>”中“字段</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>1</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>”的值时，显示数据表为查询表单中“字段</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>1</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>”对应内容的数据。</span></p>
  <p class=MsoNormal><span style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>字段名不是以</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>item_</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>起头的，就要定义一个别名，别名是以</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>item_</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>起头，因为如果不是以</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>item_</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>起头，数据项的值将无法获取到值。</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  sql = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  value = getItemValue(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>字段</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>1&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  (value!=</span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>null</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> &amp;&amp; value.trim().length() &gt;
  0){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  sql = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot; and ITEM_</span><span style='font-size:10.0pt;
  font-family:宋体;color:#2A00FF'>字段</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'>1='&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>+value+</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;'&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;SELECT * FROM&nbsp; TLK_</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>视图示例</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>_sql where
  istmp=0&nbsp; &quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>+sql;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>&nbsp;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>//SQL</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>语句实现，映射表单数据查询</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>查询映射表单</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#3F7F5F'>tb_mapping</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>中</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>name</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>与</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>title</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>字段内容。</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  sql = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;select d.*,m.name,m.title from t_document d&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  +=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot; inner join tb_mapping m on d.mappingid=m.keyname&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>sql;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>2</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>在视图中显示多个数据表（多表查询）的内容</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:80.25pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:80.25pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>通过过滤中代码</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#3F7F5F'>(SQL)</span><span style='font-size:
  10.0pt;font-family:宋体;color:#3F7F5F'>来实现多个数据表（多表查询）的内容，主要通过主子表来实现多表单的数据查询，查询子表单中</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>finished</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>与</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>date</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>字段的数据。</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  sql=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;SELECT d.*,sub.item_finished,sub.item_date from
  tlk_fm_task d&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  +=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot; inner join tlk_fm_task_sub sub on d.id=sub.parent&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>sql;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>3</span></b><b><span
style='font-family:宋体'>：</span></b><span lang=EN-US>SQL</span><span
style='font-family:宋体'>语句实现已办数据查询</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  sql=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;select * from tlk_</span><span style='font-size:10.0pt;
  font-family:宋体;color:#2A00FF'>会议记录</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'> doc where '&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>+getWebUser().getId();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  +=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;' in (select u.ACTORID from T_ACTORHIS a,t_relationhis
  r&quot;</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  +=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot; where r.docid=doc.id and a.nodehis_id=r.id&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  +=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot; AND r.flowid in &quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  +=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;(SELECT flowid FROM t_flowstatert WHERE docid=doc.id ))
  &quot;</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>sql;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>4</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>实现待办数据查询</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//DQL</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>实现</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  dql =</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;$formname='formname' and $state.actors.actorid='&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  +getWebUser().getId() + </span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;'&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>dql;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//SQL</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>实现</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  sql=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;select d.* from tlk_tablename d&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  +=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot; where (d.id in (select states.docid&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  +=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot; from t_flowstatert states, t_actorrt actors&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  +=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot; where states.id = actors.flowstatert_id&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  +=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot; and actors.actorid ='&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'> +getWebUser().getId()
  + </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;'))&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>sql;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h2><span lang=EN-US>2.3</span><a name="View_Column"><span style='font-family:
宋体'>定义列</span></a></h2>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>定义列的显示，我们可以通过两种方式来实现：</span><span
lang=EN-US>FIELD</span><span style='font-family:宋体'>和</span><span lang=EN-US>SCRIPT</span><span
style='font-family:宋体'>；</span></p>

<p class=MsoNormal><span style='font-family:宋体'>（</span><span lang=EN-US>1</span><span
style='font-family:宋体'>）</span><span lang=EN-US>FIELD</span><span
style='font-family:宋体'>，视图中默认的方式，根据视图查询的表单，选择对应表单的列；</span></p>

<p class=MsoNormal><span style='font-family:宋体'>（</span><span lang=EN-US>2</span><span
style='font-family:宋体'>）</span><span lang=EN-US>SCRIPT</span><span
style='font-family:宋体'>，通过代码来显示数据。</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>2.3.1</span></st1:chsdate><span
style='font-family:宋体'>获取表单字段值</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>获取相关表单字段的值，实现的方式有两种类型：</span><span
lang=EN-US>FIELD</span><span style='font-family:宋体'>和</span><span lang=EN-US>SCRIPT</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-36.0pt'><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>（</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>）</span><span lang=EN-US style='font-size:7.0pt;
font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US>FIELD</span><span style='font-family:宋体'>，视图中默认的方式，根据视图查询的表单，选择对应表单的列</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-36.0pt'><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>（</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>）</span><span lang=EN-US style='font-size:7.0pt;
font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
lang=EN-US>SCRIPT</span><span style='font-family:宋体'>，通过代码来显示数据，具体示例如下：</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:32.0pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:32.0pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> <span
  style='background:silver'>value</span> = getItemValue(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>地区</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black;background:silver'>value</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:black'>;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>2.3.2</span></st1:chsdate><span
style='font-family:宋体'>值转换</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>通过视图列配置来实现值转换，需要使用</span><span
lang=EN-US>iScript</span><span style='font-family:宋体'>代码的方式来实现</span><span
lang=EN-US> (</span><span style='font-family:宋体'>具体实例请参考</span><span
lang=EN-US>myApps</span><span style='font-family:宋体'>功能示例</span><span
lang=EN-US>/</span><span style='font-family:宋体'>视图示例</span><span lang=EN-US>/</span><span
style='font-family:宋体'>数据转换</span><span lang=EN-US>)</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:226.5pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:226.5pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>获取当前文档“地区”字段的值，当值等于</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#3F7F5F'>010</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>时显示北京，当值等于</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>020</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>是显示广州，当值等于</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>021</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>时显示上海。“地区”列的值脚本。</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  doc = getCurrentDocument();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> <span
  style='background:silver'>value</span> = doc.getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>地区</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  rtn=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>''</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(<span
  style='background:silver'>value</span>==</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;010&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>)</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  rtn=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;</span><span style='font-size:10.0pt;font-family:宋体;
  color:#2A00FF'>北京</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#2A00FF'> &quot;</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>else</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> </span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(<span
  style='background:silver'>value</span>==</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>'020'</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>)</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  rtn=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;</span><span style='font-size:10.0pt;font-family:宋体;
  color:#2A00FF'>广州</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#2A00FF'> &quot;</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>else</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> </span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(<span
  style='background:silver'>value</span>==</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>'021'</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>)</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  rtn=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;</span><span style='font-size:10.0pt;font-family:宋体;
  color:#2A00FF'>上海</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#2A00FF'> &quot;</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>else</span></b></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  rtn= <span style='background:silver'>value</span>;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>rnt;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span style='font-family:宋体'>前台显示的效果是：</span></p>

<p class=MsoNormal><span lang=EN-US><img width=553 height=148 id="_x0000_i1053"
src="index.files/image029.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>2.3.3</span></st1:chsdate><span
style='font-family:宋体'>获取其它表单字段值</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:80.75pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:80.75pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>列上通过</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#3F7F5F'>SCRIPT</span><span style='font-size:
  10.0pt;font-family:宋体;color:#3F7F5F'>代码实现。这里我们以根据物料编辑获取物料名称为例。</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  code = getItemValueAsString(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;code&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> <span
  style='background:silver'>dql</span> = </span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;$formname='</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>物料表单</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>'
  and code='&quot;</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:black'> + code + </span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;'&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> doc
  = findByDQL(<span style='background:silver'>dql</span>);</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>doc.getItemValueAsString(</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;name&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>2.3.4</span></st1:chsdate><span
style='font-family:宋体'>在列上显示操作</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>列上通过</span><span
lang=EN-US>SCRIPT</span><span style='font-family:宋体'>代码实现，当点击列名为中“编辑”按钮时，进入当前行中的表单。</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例：</span></b><span
style='font-family:宋体'>编辑操作按钮</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:145.75pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:145.75pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  doc = getCurrentDocument();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> <span
  style='background:silver'>rtn</span> = </span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;&lt;input
  type='Button' value='</span><span style='font-size:10.0pt;font-family:宋体;
  color:#2A00FF'>编辑</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#2A00FF'>' &quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black;
  background:silver'>rtn</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>+=</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;onclick='javascript:document.forms[0].action=\&quot;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black;
  background:silver'>rtn</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>+=getContextPath();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black;
  background:silver'>rtn</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>+=</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;/portal/dynaform/document/view.action&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black;
  background:silver'>rtn</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>+= </span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;?_docid=&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> +
  doc.getId() + </span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#2A00FF'>&quot;&amp;_formid=&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> +
  doc.getFormid();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black;
  background:silver'>rtn</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>+= </span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;&amp;r_edit=true\&quot;;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black;
  background:silver'>rtn</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>+= </span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;document.forms[0].submit();'/&gt;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black;
  background:silver'>rtn</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span style='font-family:宋体'>效果如下：</span></p>

<p class=MsoNormal><span lang=EN-US><img width=553 height=125 id="_x0000_i1054"
src="index.files/image030.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>2.3.5</span></st1:chsdate><span
style='font-family:宋体'>在列上显示图片</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>示例：</span></b></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:161.5pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:161.5pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>列通过</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#3F7F5F'>SCRIPT</span><span style='font-size:10.0pt;
  font-family:宋体;color:#3F7F5F'>代码实现，获取相关表单“地区”字段的值，当值等于</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>010</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>和</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>020</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>和</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>021</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>时，显示服务器上相关图片，否者显示另一种相关图片。“结果”列的值脚本。</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  value = getItemValue(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>地区</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  rtn=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(value==</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;010&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> ||
  value==</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;020&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> || value==</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;021&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  rtn=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&lt;img
  src='/obpm/resource/image/backstatelabel.gif'/&gt;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>else</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>{</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  rtn=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&lt;img
  src='/obpm/resource/image/terminate1.gif'/&gt;&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>rtn;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>2.3.6</span></st1:chsdate><span
style='font-family:宋体'>在列上显示超链接</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>列通过</span><span
lang=EN-US>SCRIPT</span><span style='font-family:宋体'>代码实现</span><span
lang=EN-US>(</span><span style='font-family:宋体'>具体实例请参考</span><span lang=EN-US>myApps</span><span
style='font-family:宋体'>功能示例</span><span lang=EN-US>/</span><span
style='font-family:宋体'>视图示例</span><span lang=EN-US>/</span><span
style='font-family:宋体'>多样式列视图示例</span><span lang=EN-US>)</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例：</span></b><span
style='font-family:宋体'>列链接到其它网址</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:176.5pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:176.5pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>以字符串的形式获取相关表单“</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#3F7F5F'>task_type</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>”字段的值，当字段值为</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>0</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>时，显示打开百度并在当前页面中链接到百度地址，当字段值为</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>1</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>时，显示打开百度并在当前页面中链接到谷歌地址。</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  value = getItemValueAsString(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;task_type&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> (</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;0&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>.equals(value)){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&lt;a href='http://www.baidu.com'&gt;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>打开百度</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&lt;/a&gt;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>else</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> </span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> (</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;1&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>.equals(value)){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&lt;a href='http://www.google.com'&gt;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>打开谷歌</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&lt;/a&gt;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>rtn;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h2><span lang=EN-US>2.4</span><span style='font-family:宋体'>操作</span></h2>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>2.4.1</span></st1:chsdate><a
name="View_Activity"></a><span style='font-family:宋体'>基本操作类型</span></h3>

<p class=MsoNormal><span style='font-family:宋体'>说明：操作的类型有：查询，创建，删除，批量提交，导出</span><span
lang=EN-US>EXCEL</span><span style='font-family:宋体'>，导入</span><span lang=EN-US>EXCEL</span><span
style='font-family:宋体'>，清空所有数据，文件下载，批量签章</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>(1)</span><span lang=EN-US style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>查询：对应视图的查询表单功能</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>(2)</span><span lang=EN-US style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>创建：创建关联表单新数据</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>(3)</span><span lang=EN-US style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>删除：删除所选记录</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>(4)</span><span lang=EN-US style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>批量审批：对数据信息进行大量的审批提交（表单有绑定流程）</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>(5)</span><span lang=EN-US style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>导出</span><span lang=EN-US>EXCEL</span><span
style='font-family:宋体'>：导出视图数据的</span><span lang=EN-US>EXCEL</span><span
style='font-family:宋体'>文件</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>(6)</span><span lang=EN-US style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>导入</span><span lang=EN-US>EXCEL</span><span
style='font-family:宋体'>：根据导入映射的配置，导入相关数据</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>(7)</span><span lang=EN-US style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>清空所有数据：清空所选表单的数据</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>(8)</span><span lang=EN-US style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>文件下载：下载相关文件，通过文件名称脚本，指向下载文件的相对路径，例如</span><span
lang=EN-US>”/uploads/aaa.txt”</span><span style='font-family:宋体'>，下载服务器上</span><span
lang=EN-US>uploads</span><span style='font-family:宋体'>文件夹下名为</span><span
lang=EN-US>aaa.txt</span><span style='font-family:宋体'>的文件</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>(9)</span><span lang=EN-US style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>批量签章：对所有表单进行签章</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>2.4.2</span></st1:chsdate><a
name="View_Activity_BeforeAction"></a><span style='font-family:宋体'>动作前执行脚本</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>视图按钮动作执行前脚本，是指按钮的动作执行前触发此脚本。通常做动作执行前校验操作。</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例：</span></b><span
style='font-family:宋体'>校验是否勾选了记录</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:113.25pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:113.25pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>这里我们以删除按钮动作执行前脚本为例。删除之前需要选择被删除记录。</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  selects = <span style='background:silver'>getParameterAsArray</span>(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;_selects&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  (selects ==</span><b><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#7F0055'>null</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'> ||
  selects.length&lt;0){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;</span><span style='font-size:10.0pt;font-family:宋体;
  color:#2A00FF'>请选择记录！</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>rtn;</span></p>
  </td>
 </tr>
</table>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>2.4.3</span></st1:chsdate><a
name="View_Activity_AfterAction"></a><span style='font-family:宋体'>动作后执行脚本</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>视图按钮动作执行后脚本，是指按钮的动作执行后触发此脚本。</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例：</span></b><span
style='font-family:宋体'>更新选中记录相关的信息</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:129.5pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:129.5pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>这里在按钮执行后脚本里来更新选中的记录信息。</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  docids = getParameterAsArray(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;_selects&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> <span
  style='background:silver'>process</span> =
  getDocProcess(getApplication());&nbsp;&nbsp; </span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//Document</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>操作类</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>for</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  i=0;i&lt;docids.length;i++){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> doc = <span style='background:silver'>process</span>.doView(docids[i]);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  doc.findItem(</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#2A00FF'>&quot;am_apply_status&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>).setValue(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>'</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>己成生</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>'</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  <span style='background:silver'>process</span>.doUpdate(doc );</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>}</span></p>
  </td>
 </tr>
</table>

<h1><span lang=EN-US>3</span><a name="Flow_Info"><span style='font-family:宋体'>流程</span></a></h1>

<h2><span lang=EN-US>3.1</span><a name="Flow_Statelabel"><span
style='font-family:宋体'>状态标签</span></a></h2>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>状态标签是节点状态的显示，前台中一般显示在进入流程中表单的右上角。表单中可以根据获取到流程的状态来决定表单中某字段的值。表单通过脚本获取状态标签：</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:129.5pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:129.5pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>//</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>方法</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#3F7F5F'>1</span><span style='font-size:10.0pt;
  font-family:宋体;color:#3F7F5F'>：</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  doc = getCurrentDocument();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> statelabel
  = doc.getStateLabel();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>statelabel;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>//</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>方法</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#3F7F5F'>2</span><span style='font-size:10.0pt;
  font-family:宋体;color:#3F7F5F'>：</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  statelabel = getStateLabel();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>statelabel;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例：</span></b><span
style='font-family:宋体'>“软件缺陷管理系统模板”，表单中“指派给”字段是通过流程状态获取的值，其值根据状态变化而变化，这里的用户变量“</span><span
lang=EN-US>users</span><span style='font-family:宋体'>”的值是获得某个指定角色下的所有用户，是一个集合，需要通过遍历（如：</span><span
lang=EN-US>var iter =&nbsp; users.getDatas().iterator(); iter.hasNext();</span><span
style='font-family:宋体'>）后返回选项值，因此控件使用了下拉框，脚本写在该控件属性中的选项脚本。</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:420.0pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:420.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>/*</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>当流程状态标签值为空和“</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#3F7F5F'>FindBug</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>”和“</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>TestBug</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>”时获取</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>Developer</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>角色下的所有用户，否者当值为“</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>FixBug</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>”状态时获取</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>Tester</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>角色下的所有用户，当值为“</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>AssignBug</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>”时获取</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>Developer</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>角色下的所有用户。</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  opts = createOptions();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>opts.add(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> doc
  = getCurrentDocument();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  process = <span style='background:silver'>createProcess</span>(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;cn.myapps.core.user.ejb.UserProcess&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  users = </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>null</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  statelabel = doc.getStateLabel();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(statelabel
  == </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>null</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> || statelabel == </span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>'FindBug'</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> ||
  statelabel == </span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#2A00FF'>'TestBug'</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  users = process.doQueryByRoleId(</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;11de-a80d-a8e5d7bb-b638-55c259677fcd&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>else</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> </span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(statelabel
  == </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>'FixBug'</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  users = process.doQueryByRoleId(</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;11de-a80d-b3e7fd0d-b638-55c259677fcd&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>else</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> </span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(statelabel
  == </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;AssignBug&quot;</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:black'>){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  users = process.doQueryByRoleId(</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;11de-a80d-a8e5d7bb-b638-55c259677fcd&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  (users!=</span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>null</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> &amp;&amp; users.rowCount &gt; 0){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>for</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>(</span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  iter =&nbsp; users.getDatas().iterator(); iter.hasNext();) {</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> user = iter.next();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> userno = user.getLoginno();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> username = user.getName();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  opts.add(username,userno);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  }</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>opts;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h2><span lang=EN-US>3.2</span><a name="Flow_Countersign"><span
style='font-family:宋体'>会签</span></a></h2>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>传统意义上的会签是指<span
style='letter-spacing:.4pt'>撰拟公文的过程中，主办单位主动与有关单位协商并核签的一种办文程序，一般当公文的内容涉及本单位的多个部门或与其他单位有关时，需要进行会签。</span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体;
letter-spacing:.4pt'>流程会签，是指当前环节需要会签，则需要等待当前环节的所有审批人都审批完成，当前环节才算完结，流程才流转到下一环节。</span></p>

<h2><span lang=EN-US>3.3</span><a name="Flow_Branch"><span style='font-family:
宋体'>分支</span></a></h2>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>分支是</span><span
lang=EN-US>A-&gt;{B,C,D}-&gt;E</span><span style='font-family:宋体'>（这里的</span><span
lang=EN-US>A,B,C,D,E</span><span style='font-family:宋体'>指的是流程中左侧图标的手动节点，箭头指的是流程中左侧图标的关联节点），</span><span
lang=EN-US> A</span><span style='font-family:宋体'>执行完以后，可以根据需求对</span><span
lang=EN-US>B,C,D</span><span style='font-family:宋体'>多个流程节点进行选择和判断。对</span><span
lang=EN-US>B,C,D</span><span style='font-family:宋体'>分支节点进行多和单的节点选择（这个是在流程节点属性的审批设置中对审批送出设置和审批到达设置中进行选择设定）；判断流程的走向，一般是在流程的关联节点上进行设置。具体示例请参考</span><span
lang=EN-US>myApps</span><span style='font-family:宋体'>功能示例</span><span
lang=EN-US>/</span><span style='font-family:宋体'>流程示例</span><span lang=EN-US>/</span><span
style='font-family:宋体'>流程分支示例，</span> <span style='font-family:宋体'>这里建单人创建文档后提交流程，流程根据表单中“字段</span><span
lang=EN-US>2</span><span style='font-family:宋体'>”的值进行路径的判断。大于</span><span
lang=EN-US>100</span><span style='font-family:宋体'>走“分支</span><span lang=EN-US>1.1</span><span
style='font-family:宋体'>”，小于</span><span lang=EN-US>100</span><span
style='font-family:宋体'>走“分支</span><span lang=EN-US>2.1</span><span
style='font-family:宋体'>”，根据逻辑这是个单选。因此分别在关联节点和建单人以及分支节点上进行审批设置。</span></p>

<h2><span lang=EN-US>3.4</span><a name="Flow_Supervene"><span style='font-family:
宋体'>并发流程</span></a></h2>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>并发流程是</span><span
lang=EN-US>A-&gt;{B,C,D}-&gt;E</span><span style='font-family:宋体'>（这里的</span><span
lang=EN-US>A,B,C,D,E</span><span style='font-family:宋体'>指的是流程中左侧图标的手动节点，箭头指的是流程中左侧图标的关联节点），</span><span
lang=EN-US> A</span><span style='font-family:宋体'>执行完以后，让</span><span
lang=EN-US>B</span><span style='font-family:宋体'>，</span><span lang=EN-US>C</span><span
style='font-family:宋体'>，</span><span lang=EN-US>D</span><span style='font-family:
宋体'>来执行，他们的执行没有先后顺序，只有他们三个全部执行完以后，才能到下个流程节点</span><span lang=EN-US>E</span><span
style='font-family:宋体'>。这里的流程节点属性设置中，其中，在</span><span lang=EN-US>A</span><span
style='font-family:宋体'>节点审批设置审批送出节点设置“当下步有多个审批节点时</span><span lang=EN-US>,</span><span
style='font-family:宋体'>可以选择多个节点”，</span><span lang=EN-US>E</span><span
style='font-family:宋体'>节点中审批到达节点设置“当上步有多个审批节点时</span><span lang=EN-US>,</span><span
style='font-family:宋体'>所有节点完成</span><span lang=EN-US>,</span><span
style='font-family:宋体'>流程可以到达”</span></p>

<h2><span lang=EN-US>3.5</span><a name="Flow_Subflow"><span style='font-family:
宋体'>调用子流程</span></a></h2>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>子流程作为父流程中的一种特殊的活动出现。子流程在父流程中，所处的只是一个节点，因此在进行流程处理时，子流程只当做一个流程的节点来看待。调用子流程只是当前流程处理到子流程节点这个环节时，主流程会通知流程引擎，流程引擎开始启动并调用子流程。</span></p>

<h2><span lang=EN-US>3.6</span><a name="Flow_BindForm"><span style='font-family:
宋体'>绑定表单并设置权限</span></a></h2>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>流程中在手动节点的基本信息中进行对应的表单绑定，可表单字段进行“只读”，“修改”，“隐藏”的权限控制。默认情况下所有表单字段都是“修改”的权限，因此：</span></p>

<p class=MsoNormal><span style='font-family:宋体'>（</span><span lang=EN-US>1</span><span
style='font-family:宋体'>）绑定表单，需要修改其中某些字段的“修改”的权限，按照流程的实际需求；</span></p>

<p class=MsoNormal><span style='font-family:宋体'>（</span><span lang=EN-US>2</span><span
style='font-family:宋体'>）解除绑定，将表单所有字段权限改为“修改”即可。</span></p>

<h1><span lang=EN-US>4</span><span style='font-family:宋体'>报表</span></h1>

<h2><span lang=EN-US>4.1</span><a name="Report_Cross"><span style='font-family:
宋体'>交叉报表</span></a></h2>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:18.0pt'><span style='font-family:宋体'>交叉表单是报表中常见的类型，可以配置行和列数据汇总。它的视图查询模式可分为</span><span
lang=EN-US>sql.dql,form</span></p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
lang=EN-US>(1)</span><span lang=EN-US style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span><span lang=EN-US>sql:</span><span style='font-family:宋体'>通过</span><span
lang=EN-US>ISCRIPT</span><span style='font-family:宋体'>语句实现，具体可以参考视图中的代码（</span><span
lang=EN-US>SQL</span><span style='font-family:宋体'>）</span></p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
lang=EN-US>(2)</span><span lang=EN-US style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span><span lang=EN-US>dql</span><span style='font-family:宋体'>：通过</span><span
lang=EN-US>ISCRIPT</span><span style='font-family:宋体'>语句实现，具体可以参考视图中的代码（</span><span
lang=EN-US>DQL</span><span style='font-family:宋体'>）</span></p>

<p class=MsoNormal style='margin-left:18.0pt;text-indent:-18.0pt'><span
lang=EN-US>(3)</span><span lang=EN-US style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span><span lang=EN-US>form</span><span style='font-family:宋体'>：通过</span><span
lang=EN-US>ISCRIPT</span><span style='font-family:宋体'>语句实现，具体可以参考视图中的设计</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h2><span lang=EN-US>4.2</span><a name="Report_List"><span style='font-family:
宋体'>列表</span></a></h2>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>列表通过视图设计实现，其实现方式有：</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-36.0pt'><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>（</span><span
lang=EN-US>1</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>）</span><span lang=EN-US style='font-size:7.0pt;
font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-family:宋体'>将视图基本信息只读设置为“是”</span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-36.0pt'><span
style='font-family:宋体;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>（</span><span
lang=EN-US>2</span><span style='font-family:宋体;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>）</span><span lang=EN-US style='font-size:7.0pt;
font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='font-family:宋体'>将试图列信息中的是否汇总标记上，对列进行汇总</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h2><span lang=EN-US>4.3</span><a name="Report_Graph"><span style='font-family:
宋体'>自定义报表（</span><span lang=EN-US>Beta</span></a><span style='mso-bookmark:
Report_Graph'></span><span style='font-family:宋体'>）</span></h2>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>用户根据自己的需求定义表单的统计方式，目前实现了图表视图和仪表版；表格视图，矩阵视图和汇总视图正在开发中。</span></p>

<p class=MsoNormal><span style='font-family:宋体'>用户在后台通过菜单的自定义链接（内部）来调用自定义报表界面，链接地址如下：</span></p>

<p class=MsoNormal><span lang=EN-US>/portal/share/report/oReport/oReport.jsp </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h1><span lang=EN-US>5</span><span style='font-family:宋体'>脚本语言</span><span
lang=EN-US>iScript</span></h1>

<h2><span lang=EN-US>5.1</span><span style='font-family:宋体'>常见效果实现</span></h2>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>5.1.1</span></st1:chsdate><span
style='font-family:宋体'>执行</span><span lang=EN-US>SQL</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体'>执行</span><span
lang=EN-US>SQL</span><span style='font-family:宋体'>分别可通过<span lang=EN-US>queryByDSName(dsName,sql)</span>、<span
lang=EN-US>insertByDSName(dsName,sql)</span>、<span lang=EN-US>updateByDSName(dsName,sql)</span>和<span
lang=EN-US>deleteByDSName(dsName,sql)</span>四个方法实现。</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例<span lang=EN-US>1</span>：</span></b><span
style='font-family:宋体'>执行<span lang=EN-US>SQL</span>查询</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:292.0pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:292.0pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>省份。用户首先需要创建</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>&quot;<u>kd</u>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>数据源。</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  opts = createOptions();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>opts.add(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>try</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>{</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  appid = getApplication();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  sql = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;select cityid,cityname from cityinfo where
  rootid=0&quot;</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  datas = queryByDSName(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;kd&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,sql);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(datas!=</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>null</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>for</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>(</span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  iterator = datas.iterator();iterator.hasNext();){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><b><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  map1 = iterator.next();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  &nbsp;&nbsp; </span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#3F7F5F'>//</span><span style='font-size:10.0pt;
  font-family:宋体;color:#3F7F5F'>取值</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> name= map1.get(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;cityname&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> value = map1.get(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;cityid&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  &nbsp;&nbsp; opts.add(name,value);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  }</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>catch</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(e){}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>opts;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-family:宋体'>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例<span lang=EN-US>2</span>：</span></b><span
style='font-family:宋体'>执行<span lang=EN-US>SQL</span>插入</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:97.0pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:97.0pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  doc = getCurrentDocument();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  sql = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;insert into cityinfo(cityid,cityname,rootid) &quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  +=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot; values('&quot;</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:black'>+doc.getItemValue(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;citycode&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>)+</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;','&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  +=doc.getItemValue(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;cityname&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>)+</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;',
  &quot;</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  +=doc.getItemValue(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;cityroot&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>)+</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;)&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>insertByDSName(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;kd&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,sql);</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-family:宋体'>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例<span lang=EN-US>3</span>：</span></b><span
style='font-family:宋体'>执行<span lang=EN-US>SQL</span>更新</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:97.0pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:97.0pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  doc = getCurrentDocument();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  sql = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;update cityinfo&nbsp; set cityid = &quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  +=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;'&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>+doc.getItemValue(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;citycode&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>)+</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;',
  cityname='&quot;</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  +=doc.getItemValue(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;cityname&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>)+</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;',
  rootid =&quot;</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  +=doc.getItemValue(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;cityroot&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>updateByDSName(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;kd&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,sql);</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-family:宋体'>&nbsp;</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例<span lang=EN-US>4</span>：</span></b><span
style='font-family:宋体'>执行<span lang=EN-US>SQL</span>删除</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:48.25pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:48.25pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  docid = getId();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  sql = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;delete from tlk_</span><span style='font-size:10.0pt;
  font-family:宋体;color:#2A00FF'>施工物料明细</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'> where PARENT='&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>+docid+</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;'&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>deleteByDSName(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;kd&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,sql);</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>5.1.2</span></st1:chsdate><span
style='font-family:宋体'>通过</span><span lang=EN-US>SQL</span><span
style='font-family:宋体'>查询</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>示例：</span></b><span
style='font-family:宋体'>根据当前文档</span><span lang=EN-US>ID</span><span
style='font-family:宋体'>查询子表记录。</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:340.75pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:340.75pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  value = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  docid = getId();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  sql = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;select * from tlk_fm_ticket_sub parent = '&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> +
  docid + </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;'&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  subdocs1 = queryBySQL(sql);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(subdocs1
  != </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>null</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> &amp;&amp; subdocs1.size() &gt; 0) {</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>va</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>r temp = </span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>null</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> temp1 = </span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> temp2 = </span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>for</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> (</span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  iter1 = subdocs1.iterator(); iter1.hasNext();) {</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> subdoc1 = iter1.next();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  temp1 = subdoc1.getLastmodified();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>if</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>(temp1 &gt; temp2) {</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  temp2 = temp1;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp = subdoc1;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  }</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  }</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  value = temp.getItemValueAsString(</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;finishdegree&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>else</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>{</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  value = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;0%&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>value;</span></p>
  </td>
 </tr>
</table>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>5.1.3</span></st1:chsdate><span
style='font-family:宋体'>通过</span><span lang=EN-US>DQL</span><span
style='font-family:宋体'>查询</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>示例：</span></b><span
style='font-family:宋体'>根据当前文档</span><span lang=EN-US>ID</span><span
style='font-family:宋体'>查询子表记录。</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:357.0pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:357.0pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  value = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  docid = getId();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> w1
  = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot; and $parent.$id = '&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'> + docid + </span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;'&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  dql1 = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;$formname&nbsp; = 'fm_ticket_sub'&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> +
  w1;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> subdocs1
  = queryByDQL(dql1);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(subdocs1
  != </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>null</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> &amp;&amp; subdocs1.size() &gt; 0) {</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>va</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>r temp = </span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>null</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> temp1 = </span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> temp2 = </span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>for</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> (</span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  iter1 = subdocs1.iterator(); iter1.hasNext();) {</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> subdoc1 = iter1.next();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp1 = subdoc1.getLastmodified();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>if</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>(temp1 &gt; temp2) {</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  temp2 = temp1;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  <span style='background:silver'>temp</span> = subdoc1;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  }</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  }</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  value = <span style='background:silver'>temp</span>.getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;finishdegree&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>else</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>{</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  value = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;0%&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>value;</span></p>
  </td>
 </tr>
</table>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>5.1.4</span></st1:chsdate><span
style='font-family:宋体'>通过</span><span lang=EN-US>SQL</span><span
style='font-family:宋体'>统计</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>示例：</span></b><span
style='font-family:宋体'>根据</span><span lang=EN-US>SQL</span><span
style='font-family:宋体'>语句统计对应数据表的数据记录数</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:113.25pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:113.25pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  sql = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;select count(*) from tlk_queryByDQLDomain</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>子表</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  t_count = countBySQL(sql);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(t_count
  &gt; 0) {</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;</span><span style='font-size:10.0pt;font-family:宋体;
  color:#2A00FF'>表中存在记录。</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>rtn;</span></p>
  </td>
 </tr>
</table>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>5.1.5</span></st1:chsdate><span
style='font-family:宋体'>通过</span><span lang=EN-US>DQL</span><span
style='font-family:宋体'>统计</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>示例：</span></b><span
style='font-family:宋体'>根据</span><span lang=EN-US>DQL</span><span
style='font-family:宋体'>语句统计对应表单的数据记录数。</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:113.25pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:113.25pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  dql = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;$formname='queryByDQLDomain</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>子表</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>'&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  t_count = countByDQL(dql);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> rtn
  = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(t_count
  &gt; 0) {</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;</span><span style='font-size:10.0pt;font-family:宋体;
  color:#2A00FF'>表中存在记录。</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>rtn;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>5.1.6</span></st1:chsdate><span
style='font-family:宋体'>流程节点审批人脚本</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>示例：</span></b><span
style='font-family:宋体'>流程节点审批人脚本，获取执行人的上级。这里主要是用于部门主管审批时的脚本代码。</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>执行人的上级。这里主要是用于部门主管审批时的脚本代码。</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  userid = getItemValue(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;toperson&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>用户选择框</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  userProcess = createProcess(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;cn.myapps.core.user.ejb.UserProcess&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  user = userProcess.doView(userid);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  reportto = user.getSuperior();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(reportto
  != </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>null</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  reportto;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>else</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>{</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  user;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>}</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>5.1.7</span></st1:chsdate><span
style='font-family:宋体'>视图选择框确定脚本</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>示例：</span></b><span
style='font-family:宋体'>视图框确定脚本，自动生成子表记录，刷新子表</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>视图框确定脚本，刷新子表</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  did = getId();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> parentId
  = getParameterAsText(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;_selects&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>获取视图选择框对应的</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>doc</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  parentDoc = findDocument(parentId);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(parentDoc!=</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>null</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  &amp;&amp; parentId !=</span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#7F0055'>null</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'> &amp;&amp;
  parentId.trim().length()&gt;0){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>获取视图选择框对应的</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>doc</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>的子</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>doc</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  subDocs1 = parentDoc.getChilds(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>施工物料明细</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> process
  = getDocumentProcess();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  domain = getDomainid();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  application = getApplication();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>如果子</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>doc</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>不为空，遍历子</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>doc</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>，取出每个子</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>doc</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>的值并保存到另一张子</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>doc</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>中。</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(subDocs1!=</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>null</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> sql = </span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;delete
  from tlk_</span><span style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>施工物料明细</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>
  where PARENT='&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>+did+</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;'&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  deleteByDSName(</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#2A00FF'>&quot;rims&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>,sql);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> formProcess = getFormProcess();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> form = formProcess.doViewByFormName(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>施工物料明细</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,application);
  </span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>for</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>(</span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  iter = subDocs1.iterator(); iter.hasNext();){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  &nbsp; </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> subdoc = iter.next();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  &nbsp; </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> uuid = </span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>new</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  Packages.cn.myapps.util.sequence.Sequence();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  &nbsp; </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> doc =
  process.doNew(subform,getWebUser(),createParamsTable());</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  &nbsp; doc.setIstmp(</span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#7F0055'>false</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  &nbsp; doc.setParent(did);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  &nbsp; doc.addStringItem(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>施工物料名称</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,subdoc.getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>施工物料名称</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>));</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  &nbsp; doc.addStringItem(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>数量</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,subdoc.getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>数量</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>));</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  &nbsp; doc.addStringItem(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>单位</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,subdoc.getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>单位</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>));</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  &nbsp; doc.addStringItem(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;</span><span style='font-size:
  10.0pt;font-family:宋体;color:#2A00FF'>申请人</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,subdoc.getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>申请人</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>));</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  &nbsp; process.doCreate(doc);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  }</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;}</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&lt;script&gt;&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>rtn
  += </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;var subfrms = getFormFieldByName('</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>包含元素名称</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>');&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>rtn
  += </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;if (subfrms){ &quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>rtn
  += </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;subfrms.document.location.reload();&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>rtn
  +=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;}&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>rtn
  +=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&lt;/script&gt;&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>rtn;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>5.1.8</span></st1:chsdate><span
style='font-family:宋体'>是否允许编辑文档</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>示例：</span></b><span
style='font-family:宋体'>只作者可编辑脚本</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>表单打开前执行脚本</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  user= getWebUser();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  doc = getCurrentDocument();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> author
  = doc.getAuthor();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  flag = </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>true</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  (author!=</span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>null</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> &amp;&amp;
  !user.getId().equals(author.getId())){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;
  flag=</span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>false</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>flag;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>5.1.9</span></st1:chsdate><span
style='font-family:宋体'>计算脚本</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>示例：</span></b><span
style='font-family:宋体'>通过计算脚本控件生成查看按钮</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  doc = getCurrentDocument();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  contractnumber=doc.getItemValueAsString(</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>合同编号</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  value=</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  dql = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;$formname='fm_twgb_contract'&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>dql
  += </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot; and </span><span style='font-size:10.0pt;font-family:
  宋体;color:#2A00FF'>合同编号</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'> ='&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'> +
  contractnumber + </span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#2A00FF'>&quot;'&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  contractdocs = queryByDQL(dql);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>(contractdocs!=</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>null</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  &amp;&amp; contractdocs.size()&gt;0){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>&nbsp; contractdoc =
  contractdocs.get(0);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> docUrl = getContextPath()+ </span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;/portal/dynaform/document/view.action?_docid=&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;
  docUrl += contractdoc.getId()+</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;&amp;formid=&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>+contractdoc.getFormid()
  ;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;
  value = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&lt;input type=button value='</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>查看</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>'
  onclick='window.showModalDialog(\&quot;&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;
  value += docUrl+</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#2A00FF'>&quot;\&quot;,\&quot;\&quot;,\&quot;resizable=yes;help=no;status=no;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;
  value += </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;font-size:9pt;dialogWidth:850px;dialogHeight:600px;status:no;scroll:no;\&quot;)'&gt;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>value;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h3><st1:chsdate Year="1899" Month="12" Day="30" IsLunarDate="False"
IsROCDate="False" w:st="on"><span lang=EN-US>5.1.10</span></st1:chsdate><span
style='font-family:宋体'>创建</span><span lang=EN-US>Document</span></h3>

<p class=MsoNormal><b><span style='font-family:宋体'>示例：</span></b><span
style='font-family:宋体'>通过</span><span lang=EN-US>iScript</span><span
style='font-family:宋体'>脚本以从当前文档获取数据直接创建文档。</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:176.5pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:176.5pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  formProcess = getFormProcess();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  form = formProcess.doViewByFormName(</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;fm_purchase_materials&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,getApplication());&nbsp;
  </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#3F7F5F'>//</span><span style='font-size:10.0pt;font-family:宋体;
  color:#3F7F5F'>查询出表单</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  process = <span style='background:silver'>getDocumentProcess</span>();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  doc = process.doNew(form,getWebUser(),createParamsTable());</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>doc.findItem(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;title&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>).setValue(getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>标题</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>));</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>doc.findItem(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;type&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>).setValue(getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>类型</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>));</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>doc.findItem(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;count&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>).setValue(getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>数量</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>));</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>doc.setIstmp(</span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>false</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>process.doCreate(doc);</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h1><span lang=EN-US>6 DQL</span><span style='font-family:宋体'>语法</span></h1>

<p class=MsoNormal style='line-height:150%'><b><span style='font-family:宋体'>语法格式：</span></b></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US>$formname=’</span><span style='font-family:宋体'>表单名</span><span
lang=EN-US>’ [AND <i>filter1……</i>]</span></p>

<p class=MsoNormal style='line-height:150%'><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US>$formname</span><span style='font-family:宋体'>：标识查询的表单；</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US>AND filter1……</span><span style='font-family:宋体'>：表示带过滤条件查询。</span></p>

<p class=MsoNormal style='line-height:150%'><b><span style='font-family:宋体'>示例</span><span
lang=EN-US>1</span></b><b><span style='font-family:宋体'>：</span></b><span
style='font-family:宋体'>在表单控件校验脚本中的应用：</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:152.75pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:152.75pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  doc = getCurrentDocument();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> dql
  = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;$formname='</span><span style='font-size:10.0pt;
  font-family:宋体;color:#2A00FF'>表单</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:#2A00FF'>1' AND code='TASK0001' AND
  $id &lt;&gt;'&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>+doc.getId()+</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;'&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  datas = queryByDQL(dql);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  (datas.size()&gt;0){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  rtn = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;</span><span style='font-size:10.0pt;font-family:宋体;
  color:#2A00FF'>系统中已经存在编号为：</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>TASK0001 </span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>的记录！</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>}</span></p>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:10.0pt;line-height:150%;font-family:"Courier New";
  color:black'>rtn;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='line-height:150%'><span style='font-family:宋体'>示例</span><span
lang=EN-US>2</span><span style='font-family:宋体'>：在视图中</span><span lang=EN-US>DQL</span><span
style='font-family:宋体'>模式内容的应用：</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  value1 = getItemValue(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;_</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>申请单号</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> <span
  style='background:silver'>value2</span> = getItemValue(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;_</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>请假类别</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  where = ( value1 != </span><b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#7F0055'>null</span></b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'> &amp;&amp;
  value1.trim().length() &gt; 0) ?&nbsp; </span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot; and _</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>申请单号</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>
  like '&quot;</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>+ value1+</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;%'&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> : </span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>where
  += ( <span style='background:silver'>value2</span> != </span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>null</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  &amp;&amp; <span style='background:silver'>value2</span>.trim().length() &gt;
  0) ?&nbsp; </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot; and _</span><span style='font-size:10.0pt;font-family:
  宋体;color:#2A00FF'>请假类别</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>='&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp; + <span
  style='background:silver'>value2</span> + </span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;'&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> : </span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='font-size:10.0pt;line-height:150%;font-family:"Courier New";
  color:#2A00FF'>&quot;$formname=' TLK_</span><span style='font-size:10.0pt;
  line-height:150%;font-family:宋体;color:#2A00FF'>请假申请</span><span lang=EN-US
  style='font-size:10.0pt;line-height:150%;font-family:"Courier New";
  color:#2A00FF'>4' &quot;</span><span lang=EN-US style='font-size:10.0pt;
  line-height:150%;font-family:"Courier New";color:black'> + where;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='line-height:150%'><b><span style='font-family:宋体'>总结：</span></b></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
DQL</span><span style='font-family:宋体'>语句中使用到了</span><span lang=EN-US>code</span><span
style='font-family:宋体'>字段与</span><span lang=EN-US>$id</span><span
style='font-family:宋体'>字段进行过滤。其中，</span><span lang=EN-US>$id</span><span
style='font-family:宋体'>表示使用系统字段</span><span lang=EN-US>ID</span><span
style='font-family:宋体'>；</span><span lang=EN-US>code</span><span
style='font-family:宋体'>字段为用户通过表单配置的字段名。在</span><span lang=EN-US>DQL</span><span
style='font-family:宋体'>语句中凡使用系统字段都需要在字段名前加</span><span lang=EN-US>”$”</span><span
style='font-family:宋体'>符号，用户配置字段可直接使用。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
style='font-family:宋体'>上面的例子是通过脚本的形式返回一个</span><span lang=EN-US>DQL</span><span
style='font-family:宋体'>语句的字符串，系统会根据这个</span><span lang=EN-US>DQL</span><span
style='font-family:宋体'>语句进行查询。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h1><span lang=EN-US>7</span><span style='font-family:宋体'>其它问题</span></h1>

<p class=315><span lang=EN-US>7.1</span><a name="_Toc281847048"><span
style='font-family:黑体'>表单系统保留字段</span></a></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="98%"
 style='width:98.0%;margin-left:4.65pt;border-collapse:collapse;mso-padding-alt:
 0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  background:#CCCCCC;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><b><span
  style='font-size:12.0pt;line-height:150%;font-family:宋体'>系统字段</span></b></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border:solid windowtext 1.0pt;
  border-left:none;background:#CCCCCC;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><b><span
  style='font-size:12.0pt;line-height:150%;font-family:宋体'>描述</span></b></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='font-family:"Times New Roman"'>ID</span></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  style='font-family:宋体'>记录唯一标识字段</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='font-family:"Times New Roman"'>PARENT</span></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  style='font-family:宋体'>存储父记录</span><span lang=EN-US style='font-family:"Times New Roman"'>ID</span><span
  style='font-family:宋体'>标识字段</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='font-family:"Times New Roman"'>LASTMODIFIED</span></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  style='font-family:宋体'>最后修改时间</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='font-family:"Times New Roman"'>FORMNAME</span></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  style='font-family:宋体'>对应模板表单名称</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='font-family:"Times New Roman"'>STATE</span></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  style='font-family:宋体'>流程当前状态记录</span><span lang=EN-US style='font-family:
  "Times New Roman"'>ID</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='font-family:"Times New Roman"'>AUDITDATE</span></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  style='font-family:宋体'>最近一次的审批时间</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='font-family:"Times New Roman"'>AUTHOR</span></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  style='font-family:宋体'>最近一次的审批人</span><span lang=EN-US style='font-family:
  "Times New Roman"'>ID</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='font-family:"Times New Roman"'>CREATED</span></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  style='font-family:宋体'>创建记录时间</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='font-family:"Times New Roman"'>FORMID</span></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  style='font-family:宋体'>表单</span><span lang=EN-US style='font-family:"Times New Roman"'>ID</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='font-family:"Times New Roman"'>ISTMP</span></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  style='font-family:宋体'>是否为临时记录</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='font-family:"Times New Roman"'>FLOWID</span></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  style='font-family:宋体'>流程</span><span lang=EN-US style='font-family:"Times New Roman"'>ID</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='font-family:"Times New Roman"'>VERSIONS</span></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  style='font-family:宋体'>版本</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='font-family:"Times New Roman"'>SORTID</span></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  style='font-family:宋体'>排序</span><span lang=EN-US style='font-family:"Times New Roman"'>ID</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:14;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='font-family:"Times New Roman"'>APPLICATIONID</span></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  style='font-family:宋体'>软件</span><span lang=EN-US style='font-family:"Times New Roman"'>ID</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:15;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='font-family:"Times New Roman"'>STATEINT</span></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  style='font-family:宋体'>流程当前状态值</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:16;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='font-family:"Times New Roman"'>STATELABEL</span></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  style='font-family:宋体'>流程当前状态标签</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:17;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='font-family:"Times New Roman"'>LASTFLOWOPERATION</span></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  style='font-family:宋体'>最近一次的审批操作类别</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:18;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='font-family:"Times New Roman"'>AUDITORNAMES</span></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  style='font-family:宋体'>当前审批人名称列表</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:19;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='font-family:"Times New Roman"'>AUDITORLIST</span></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  style='font-family:宋体'>当前审批人</span><span lang=EN-US style='font-family:"Times New Roman"'>ID</span><span
  style='font-family:宋体'>列表</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:20;mso-yfti-lastrow:yes;height:14.25pt'>
  <td width=141 nowrap valign=bottom style='width:105.75pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='font-family:"Times New Roman"'>MAPPINGID</span></p>
  </td>
  <td width=477 nowrap valign=bottom style='width:357.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.25pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  style='font-family:宋体'>表单映射</span><span lang=EN-US>ID</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h2><span lang=EN-US>7.2</span><a name="Task_Timer"><span style='font-family:
宋体'>定时任务</span></a></h2>

<p class=MsoNormal><b><span style='font-family:宋体'>说明：</span></b></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='font-family:宋体'>任务可以让系统在特定日期特定时间执行指定的任务内容，并通过终止条件结束任务。</span></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>1</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>定时清理数据</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>/*</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>方法</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>1</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>：定时清理符合</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>SQL</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>清除条件的数据</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  sql = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;delete from tlk_qs_user_enterprice_info where istmp=0
  and &quot;</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  += </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot; item_username in(select
  tlk_qs_user_enterprice_info.item_username &quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  += </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot; from tlk_qs_user_enterprice_info where istmp=0 and not
  exists(&quot;</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  += </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;select t_qe.item_username from t_user,&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  += </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot; tlk_qs_user_enterprice_info t_qe where
  t_user.id=t_qe.item_username))&quot;</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  process = </span><b><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#7F0055'>new</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:black'>
  Packages.cn.myapps.core.dynaform.dts.datasource.ejb.DataSourceProcessBean();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>process.remove(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;<st1:State
  w:st="on"><st1:place w:st="on">del</st1:place></st1:State>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,sql,getApplication());</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>/*</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>方法</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>2</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>：定时清理符合</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>SQL</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>清除条件的数据</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>*/</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//2.4</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>版本及之后可使用</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  sql = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;delete from tlk_qs_user_enterprice_info where istmp=0
  and &quot;</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  += </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot; item_username in(select
  tlk_qs_user_enterprice_info.item_username &quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  += </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot; from tlk_qs_user_enterprice_info where istmp=0 and not
  exists(&quot;</span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  += </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;select t_qe.item_username from t_user,&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>sql
  += </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot; tlk_qs_user_enterprice_info t_qe where
  t_user.id=t_qe.item_username))&quot;</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>deleteByDSName(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;<st1:State w:st="on"><st1:place
   w:st="on">del</st1:place></st1:State>&quot;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:black'>,sql);</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b><span lang=EN-US>&nbsp;</span></b></p>

<p class=MsoNormal><b><span style='font-family:宋体'>示例</span><span lang=EN-US>2</span></b><b><span
style='font-family:宋体'>：</span></b><span style='font-family:宋体'>定时发送提醒邮件</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:307.75pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:307.75pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  sql = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;select id from tlk_task where item_sendable='</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>待发</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>'&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//<u>kd</u></span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>数据源名称，需要通过</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>软件</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>-&gt;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>高级工具</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>-&gt;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>数据源</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>&quot;</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>创建一个</span><u><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>kd</span></u><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>数据源。</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  datas = queryByDSName(</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:#2A00FF'>&quot;kd&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>,sql);
  </span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>if</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  (datas!=</span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>null</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> &amp;&amp; datas.size()&gt;0){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>for</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> (</span><b><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>var</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  i=0;i&lt;datas.size();){</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> <span style='background:silver'>docid</span>
  = datas.get(</span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;id&quot;</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> doc = findDocument(<span
  style='background:silver'>docid</span>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> from=doc.getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;from&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> to=doc.getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;to&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> host=doc.getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;host&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> user=doc.getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;user&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> password=doc.getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;password&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> bbc=doc.getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;bbc&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> subject=doc.getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;subject&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><b><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#7F0055'>var</span></b><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'> body=doc.getItemValueAsString(</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;body&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  sendMail(from, to, subject, body, host, user, password, bbc, fasle);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  }</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>}</span></p>
  </td>
 </tr>
</table>

<h2><span lang=EN-US>7.3 WebService</span></h2>

<p class=MsoNormal><span style='font-family:宋体'>通过</span><span lang=EN-US>MYAPPS</span><span
style='font-family:宋体'>提供的</span><span lang=EN-US>WebService</span><span
style='font-family:宋体'>客户端接口来调用</span><span lang=EN-US>MYAPPS</span><span
style='font-family:宋体'>平台文档创建接口。</span></p>

<p class=MsoNormal><span style='font-family:宋体'>代码片断：</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:308.25pt'>
  <td width=568 valign=top style='width:426.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:308.25pt'>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>String
  formName = </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#2A00FF'>&quot;fm_task&quot;</span><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:black'>;</span><span lang=EN-US
  style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>表单名称</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>HashMap
  parameters = </span><b><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#7F0055'>new</span></b><span lang=EN-US style='font-size:
  10.0pt;font-family:"Courier New";color:black'> HashMap();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>parameters.put(<span
  style='color:#2A00FF'>&quot;title&quot;</span>, <span style='color:#2A00FF'>&quot;</span></span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>任务</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>1&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>parameters.put(<span
  style='color:#2A00FF'>&quot;startDate&quot;</span>, <span style='color:#2A00FF'>&quot;<st1:chsdate
  Year="2011" Month="1" Day="18" IsLunarDate="False" IsROCDate="False" w:st="on">2011-01-18</st1:chsdate>&quot;</span>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>parameters.put(<span
  style='color:#2A00FF'>&quot;endDate&quot;</span>, <span style='color:#2A00FF'>&quot;<st1:chsdate
  Year="2011" Month="1" Day="31" IsLunarDate="False" IsROCDate="False" w:st="on">2011-01-31</st1:chsdate>&quot;</span>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>parameters.put(<span
  style='color:#2A00FF'>&quot;type&quot;</span>, <span style='color:#2A00FF'>&quot;</span></span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>开发任务</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>parameters.put(<span
  style='color:#2A00FF'>&quot;desc&quot;</span>, <span style='color:#2A00FF'>&quot;[</span></span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>任务</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>]-[</span><span
  style='font-size:10.0pt;font-family:宋体;color:#2A00FF'>开发任务</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#2A00FF'>]-[<st1:chsdate
  Year="2011" Month="1" Day="18" IsLunarDate="False" IsROCDate="False" w:st="on">2011-01-18</st1:chsdate>]-[<st1:chsdate
  Year="2011" Month="1" Day="31" IsLunarDate="False" IsROCDate="False" w:st="on">2011-01-31</st1:chsdate>]&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New"'>);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//
  Default</span><span style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>应用</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>String
  applicationId = </span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#2A00FF'>&quot;11de-9d0c-38898b6e-ac35-a50fa32293ae&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>;</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>//
  </span><span style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>企业域下指定用户的</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>ID,</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>这里使用</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>testuser</span><span
  style='font-size:10.0pt;font-family:宋体;color:#3F7F5F'>用户的</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#3F7F5F'>ID</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>String
  domainUserId = </span><span lang=EN-US style='font-size:10.0pt;font-family:
  "Courier New";color:#2A00FF'>&quot;11de-c13a-0cf76f8b-a3db-1bc87eaaad4c&quot;</span><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>; </span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>try</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'> {</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:#0000C0'>service</span><span lang=EN-US style='font-size:10.0pt;
  font-family:"Courier New";color:black'>.createDocumentByDomainUser(formName,
  parameters, domainUserId, applicationId);</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>} </span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>catch</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  (DocumentServiceFault e) {</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  e.printStackTrace();</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>} </span><b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:#7F0055'>catch</span></b><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>
  (RemoteException e) {</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-autospace:none'><span
  lang=EN-US style='font-size:10.0pt;font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  e.printStackTrace();</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt;font-family:"Courier New";
  color:black'>}</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h2><span lang=EN-US>7.4 LDAP</span><span style='font-family:宋体'>同步</span></h2>

<h2><span lang=EN-US>7.5</span><span style='font-family:宋体'>性能调优</span></h2>

</div>

</body>

</html>
